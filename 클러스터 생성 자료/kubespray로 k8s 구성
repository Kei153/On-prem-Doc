1. ë¨¼ì € ê°€ìƒë¨¸ì‹ ì„ êµ¬ì„±í•œë‹¤. ë‚´ ì»´í“¨í„° í™˜ê²½ì€ ë§¥osì—¬ì„œ í˜¸í™˜ ì˜ ë˜ëŠ” UTMì„ ì„¤ì¹˜í•˜ì—¬ êµ¬ì„± í•˜ì˜€ë‹¤.
  UTMì€ ê°€ìƒë¨¸ì‹  ë§Œë“¤ ì´ë¯¸ì§€ê°€ í•„ìš”í•˜ê¸° ë•Œë¬¸ì— k8së¥¼ ì§€ì›í•˜ëŠ” ìš°ë¶„íˆ¬ ì´ë¯¸ì§€ë¥¼ ë‹¤ìš´ ë°›ëŠ”ë‹¤.

  - UTM ì„¤ì¹˜
    brew install --cask utm
  - ìš°ë¶„íˆ¬ ì´ë¯¸ì§€ ë‹¤ìš´ë¡œë“œ (ë‚´ ë¡œì»¬ ì»´í“¨í„° osì— ë§ëŠ” ì´ë¯¸ì§€ ë‹¤ìš´í•˜ê¸°)
     https://cdimage.ubuntu.com/releases/22.04/release/ (for ë§¥ë¶)
    https://releases.ubuntu.com/22.04/ (amd)
    
    
ğŸª› 1ë‹¨ê³„: ìƒˆ ê°€ìƒë¨¸ì‹  ë§Œë“¤ê¸°
UTM ì‹¤í–‰ > ìƒë‹¨ ë©”ë‰´ì—ì„œ + ë²„íŠ¼ í´ë¦­ (ìƒˆ ê°€ìƒ ë¨¸ì‹  ë§Œë“¤ê¸°)
"Virtualize" ì„ íƒ
ìš´ì˜ ì²´ì œ: "Linux" ì„ íƒ
ë¶€íŠ¸ ì´ë¯¸ì§€ ì„ íƒ(Boot ISO Image): 'íƒìƒ‰' ë²„íŠ¼ ëˆ„ë¥´ê³  ë‹¤ìš´ë°›ì€ ubuntu-22.04-live-server-amd64.iso ì„ íƒ
ë©”ëª¨ë¦¬ - 4ê¸°ê°€ CPU - 2core Storage - 30Gib ê³µìœ  í´ë”  - ê±´ë„ˆë›°ê¸° (default)
Summary ì—ì„œ ì´ë¦„ ì •í•˜ê³  ì €ì¥

2ë‹¨ê³„: ê°€ìƒë¨¸ì‹  êµ¬ì„±í•˜ê¸°
  ë§Œë“  ê°€ìƒë¨¸ì‹  ì¼œê¸°. ì¼œë©´ ë¶€íŒ… í™”ë©´ ë‚˜ì˜´
  - ì ë‹¹íˆ ì„ íƒí•œë‹¤. ì˜ì–´ ë“±ë“±.. ì—…ëƒì€ ë‚˜ì¤‘ì— ë“±ìœ¼ë¡œ
  - ubuntu serverë¡œ ì„ íƒí•˜ê³  ì„¤ì¹˜/ network, proxy configuration ì€ ê±´ë„ˆë›°ê¸°
  - mirror configuration ê¸°ë‹¤ë¦¬ê³  ë‹¤ ëë‚˜ëª… ë‹¤ìŒ
  - ë‚˜ë¨¸ì§€ëŠ” ê·¸ëƒ¥ ì •í•´ì§„ ëŒ€ë¡œ.. ë§ˆì§€ë§‰ profile configuration ë§Œ ì˜ ì„¤ì •
  - ê·¸ ë’¤ ë‚˜ì˜¤ëŠ” ssh configuration  ì˜ ì„¤ì •.(install openssh server ì²´í¬)
  - featured server snaps ëŠ” ê±´ë„ˆë›°ê¸°
  - install complete! ë  ë•Œê°€ì§€ ê¸°ë‹¤ë¦¬ê³  ë‹¤ ë˜ë©´ reboot
  - rebootí•˜ê³  ë¡œê·¸ì¸ í™”ë©´ ì•ˆë‚˜ì˜¤ê³  ì»¤ì„œë§Œ ê¹œë°•ì´ë©´ ìš°ì¸¡ ìƒë‹¨ì—ì„œ ë‘ë²ˆì§¸ì— ìœ„ì¹˜í•œ Drive image options ì—ì„œ 
  êº¼ë‚´ê¸°ë¥¼ ëˆ„ë¥´ê³  Linux 2 ì˜†ì— ìœ„ì¹˜í•œ Restarts the VM ì„ ëˆŒëŸ¬ ì¬ë¶€íŒ…í•˜ë©´ ì •ìƒì ìœ¼ë¡œ ì‹¤í–‰ì´ ëœë‹¤.
  (ì¶œì²˜: https://ssunw.tistory.com/entry/M1-mac-ê°€ìƒí™˜ê²½ì—-Linux-ì„¤ì¹˜í•˜ê¸°UTM-Ubuntu [ssunw:í‹°ìŠ¤í† ë¦¬])






--------------------------------------------------------------------------

** í´ëŸ¬ìŠ¤í„° êµ¬ì„± **

1. ë¨¼ì € ë‚´ ë¡œì»¬ PCì—ì„œ ë¹„ë²ˆì—†ì´ sshë§Œìœ¼ë¡œ ì ‘ì† ê°€ëŠ¥í•˜ê²Œ í‚¤ ë³µì‚¬/ì €ì¥ ì‘ì—…
  - ë‚´ ë¡œì»¬ì—ì„œ í‚¤ë¥¼ ë§Œë“ ë‹¤. (ì €ì¥ ê²½ë¡œëŠ” ~/.ssh/id_rsa ë¡œ í•¨)
    ëª…ë ¹ì–´ : ssh-keygen -t rsa -b 4096 (password ì—†ì´ ë§Œë“¬)
    ë§Œë“¤ì–´ì§„ í‚¤ ì¤‘ pubí‚¤ë¥¼ ì ‘ê·¼ í•  ê°€ìƒ ë¨¸ì‹ ì— ë³µì‚¬
    ëª…ë ¹ì–´ : ssh-copy-id -i ~/.ssh/id_rsa.pub <user>@<nodeIP>
    ì²˜ìŒ í•œ ë²ˆì€ ë¹„ë°€ë²ˆí˜¸ë¥¼ ë¬»ìŠµë‹ˆë‹¤ (ì •ìƒ)
    ì„±ê³µí•˜ë©´ ë³µì‚¬í•œ ê° ë…¸ë“œì˜ ~/.ssh/authorized_keys ì— ê³µê°œí‚¤ê°€ ìë™ ì¶”ê°€ë¨
    ì ‘ì† í…ŒìŠ¤íŠ¸ : ssh <user>@<nodeIP>

2. ë§ˆìŠ¤í„° ë…¸ë“œë¡œ ì •í•  ì„œë²„ì— ì ‘ì†í•´ì„œ k8s êµ¬ì„± ì¤€ë¹„
  - ë§ˆìŠ¤í„°ì—ì„œ ë…¸ë“œë¡œì˜ ë¹„ë²ˆ ì—†ëŠ” ssh ì ‘ì†ì„ ìœ„í•´ 1ë²ˆ ê³¼ì • ë°˜ë³µ

3. ansible ê³µì‹ í™ˆí˜ì´ì§€ ì°¸ì¡° :  https://kubespray.io/#/docs/ansible/ansible (ansible ì„¤ì¹˜ ì°¸ì¡°)
  - - ë¨¼ì € kubespray íŒ¨í‚¤ì§€ ë‹¤ìš´ë¡œë“œ : git clone https://github.com/kubernetes-sigs/kubespray.git
	-  ~kubespray ìƒê¸´ê±° í™•ì¸
	- kubespray ë””ë ‰í† ë¦¬ì—ì„œ ì‘ì—… 
	- ëª…ë ¹ì–´ : sudo apt install python3.10-venv (ê°€ìƒí™” í™˜ê²½ì—ì„œ kubespray ì„¤ì¹˜ ìœ„í•´)

4. ansible ë¬¸ì„œì— ì‰˜ ì„¸ì…˜ ì‹¤í–‰. ë§ˆì§€ë§‰ â€˜pip install -U -r requirements.txtâ€™ ê¹Œì§€ ì„¤ì¹˜.
    - # sample ë””ë ‰í† ë¦¬ë¥¼ ê¸°ì¤€ìœ¼ë¡œ ì‹¤ì œë¡œ ì‘ì—…í•  í´ë”ë¥¼ ë³µì‚¬í•œë‹¤
		: project_name=<ì´ë¦„ ì •í•˜ê¸°>
		: cp -rfp inventory/sample inventory/${project_name}
    - í•„ìš”í•œ ì„¤ì • ê°’ë“¤ í•´ë‹¹ ë¬¸ì„œ í¸ì§‘ê¸°ë¡œ ì‘ì„±
		: cd inventory/${project-name}/group_vars/k8s_cluster/addons.yaml
			- # helm ì‚¬ìš©
				helm_enabled: true
				metrics_server_enabled: true

		: cd inventory/${project-name}/group_vars/k8s_cluster/k8s-cluster.yml
			- (â€¦)
			- kube_proxy_strict_arp: true
			- (â€¦)
			- auto_renew_certificates: true

		: inventory/${project-name}/inventory.ini
			[all]
			master ansible_host=10.0.2.4 ip=10.0.2.4 ansible_user=laonpeople
			worker ansible_host=10.0.2.5 ip=10.0.2.5 ansible_user=laonpeople

			[kube_control_plane]
			master

			[etcd:children]
			kube_control_plane

			[kube_node]
			worker

5. ì„¤ì¹˜
- ansible-playbook -i inventory/${project_name}/inventory.ini --become --become-user=root cluster.yml -K
			(--become --become-user=root ëŠ” ansibleë¬¸ì„œ ì—ì„œ become ê²€ìƒ‰í•˜ë©´ ë‚˜ì˜´. rootë¡œ ì„¤ì¹˜ í•œë‹¤ëŠ” ë§ì„. -KëŠ” ì•”í˜¸ë‘ ì•”íŠ¼ ì‹¤í–‰?)

6. ì„¤ì¹˜ í›„, kubespray ê°€ìƒí™” ë¡œê·¸ ì•„ì›ƒ í•˜ê¸° python-venv 
		ëª…ë ¹ì–´ : deactivate

7. â€˜rootâ€™ ê¶Œí•œìœ¼ë¡œ ì‹¤í–‰ : kubectl get no 



